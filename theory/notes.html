<!DOCTYPE html>
<html>
    <head>
        <title>Notes</title>
        <link rel="stylesheet" href="/SoundGen/css/styles.css" />
        <style>
            #graph {
                width: 100%;
                height: 10rem;
            }
        </style>
    </head>

    <body>
        <div class="section">NOTES
            <div class="subsection">
                <label for="tonics">Tonic</label>  
                    <select id="tonics">
                        <option value="0">A</option>
                        <option value="1">A#/Bb</option>
                        <option value="2">B</option>
                        <option value="3">C</option>
                        <option value="4">C#/Db</option>
                        <option value="5">D</option>
                        <option value="6">D#/Eb</option>
                        <option value="7">E</option>
                        <option value="8">F</option>
                        <option value="9">F#/Gb</option>
                        <option value="10">G</option>
                        <option value="11">G#/Ab</option>
                    </select>
                <label for="octaves">Octave</label>  
                    <select id="octaves">
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4" selected>4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                    </select>
                <label for="waveForm">Wave form</label>  
                    <select id="waveForm">
                        <option value="sine">sine</option>
                        <option value="square">square</option>
                        <option value="triangle">triangle</option>
                        <option value="sawtooth">sawtooth</option>
                    </select>
                <label for="duration">duration (s)</label> 
                    <select id="duration">
                        <option value="0.10">0.10</option>
                        <option value="0.25">0.25</option>
                        <option value="0.50">0.50</option>
                        <option value="0.75">0.75</option>
                        <option value="1.00">1.00</option>
                        <option value="2.00">2.00</option>
                        <option value="4.00">4.00</option>
                        <option value="60">60</option>
                    </select>
            </div>
            <div class="subsection" id="buttons">  
                <button onclick="playNote()">Play</button>
                <button onclick="stopNote()">Stop</button>
            </div>
        </div>
        <div>
            <canvas id="graph"></canvas>
        </div>        
    </body>

    <script src="/SoundGen/js/AudioTone.js"></script>
    <script src="/SoundGen/js/AudioGraph.js"></script>
    <script>
        const graphOptions = {
            backgroundColor: 'darkblue',
            foregroundColor: 'white',
        }
        const tone = new AudioTone()
        const graph = new AudioGraph(document.querySelector('#graph'), tone.audioContext, graphOptions)
        const toneOptions = {
            analyser: graph.analyser, 
            //- shaper: AudioTone.saturation(1, .1)
            shaper: AudioTone.bitCrusher(3)
        }

        function playNote() {
            tone.stop()
            const tonicIndex = Number(tonics.value)
            const seconds = Number(duration.value)
            const frequency = tone.semitoneStep(tonicIndex, 0, octaves.value)
            console.log('note begin', frequency)
            tone.play(frequency, seconds, waveForm.value, toneOptions)
                .then(result => console.log(result))
                .catch(error => console.log(error.message))
        }

        function stopNote() {
            tone.stop()
        }
    </script>
</html> 